# Custom-Object-Detection
The project is an implementation of the darkflow network for custom object detection in images.

## Creating Dataset
For object detection by darkflow model, the first requirement is creation of annotated data for feeding it to the network. Annotated data is generated by the files draw_box.py and get_xml.py. 
draw_box.py is a GUI oriented python code which is used to generate XML files which can be trained on the darkflow model.  
For all the images in your dataset, you need to drag your mouse pointer starting from your upper left to your lower right. This will create XML files for each of the images in the dataset folder. 

![Demo](https://github.com/priyamehta01/Custom-Object-Detection/tree/master/images/gui.png)

## Training the model 
Clone the darkflow repository. 
Make a change in the labels.txt file by giving the name of your object, which in my case is NFPA. 
Make changes in the files as shown in the repository as shown under the 'Training on your own dataset' tab. 
The configuration file I used for the model was tiny-voc-1c.cfg, as the computational capacity I had could not train on a full fledged YOLO model.
Run the following command to load the annotation files and the cfg file to train the model (On CPU). For running on GPU, you could add an additional gpu parameter as mentioned in the darkflow repository.  
```
flow --model cfg/tiny-yolo-voc-1c.cfg --load bin/tiny-yolo-voc.weights --train --annotation train/Annotations --dataset train/Images
```

## Custom Object Detection
After the training is done, the ckpt folder will have various checkpoint files stored at different iteration values. In the image_detect.py file, load the image to detect the object from, the configuration file and the iteration value whose results you want to consider. 

![Demo](https://github.com/priyamehta01/Custom-Object-Detection/tree/master/images/output.png)

